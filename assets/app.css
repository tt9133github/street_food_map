:root{
  --border:#e9e9e9;
  --muted:#666;
  --bg:#fff;
  --card:#fafafa;
}
html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"PingFang SC","Microsoft YaHei",sans-serif;background:var(--bg);}
.topbar{
  display:flex;gap:10px;align-items:center;
  padding:10px 12px;border-bottom:1px solid var(--border);
  position:sticky;top:0;background:var(--bg);z-index:10;
  width:100%;box-sizing:border-box;
}
.topbar select,.topbar input{
  padding:8px 10px;border:1px solid #ddd;border-radius:10px;font-size:14px;
  background:#fff;
}
.topbar select{
  min-width:130px;
}
.q-wrap{position:relative;flex:1;min-width:180px;}
.topbar input{width:100%;padding-right:28px;}
.q-clear{
  position:absolute;right:8px;top:50%;transform:translateY(-50%);
  border:none;background:transparent;color:#888;font-size:16px;
  cursor:pointer;line-height:1;display:none;
}
.q-clear:hover{color:#333;}
.layout{display:grid;grid-template-columns:1fr 360px;height:calc(100% - 54px);}
#map{height:100%;width:100%;}
.side{border-left:1px solid var(--border);overflow:auto;background:#fff;}
.item{padding:10px 12px;border-bottom:1px solid #f2f2f2;cursor:pointer;}
.item:hover{background:#fafafa;}
.name{font-weight:700;}
.meta{font-size:12px;color:var(--muted);margin-top:4px;line-height:1.4;}
.badge{display:inline-block;padding:2px 8px;border:1px solid #eee;border-radius:999px;font-size:12px;margin-left:6px;color:#444;background:#fafafa;}
.warn{color:#b45309;}
.err{color:#b91c1c;}

/* 设置按钮 + 抽屉 */
.fab{
  position:fixed;right:14px;bottom:14px;z-index:99999;
  width:46px;height:46px;border-radius:14px;
  border:1px solid rgba(0,0,0,.12);
  background:rgba(255,255,255,.92);
  backdrop-filter:blur(10px);
  box-shadow:0 6px 24px rgba(0,0,0,.14);
  cursor:pointer;font-size:18px;
}
.mask{position:fixed;inset:0;background:rgba(0,0,0,.35);opacity:0;pointer-events:none;transition:.18s ease;z-index:99998;}
.drawer{
  position:fixed;top:0;right:0;height:100vh;width:min(420px,92vw);
  background:rgba(22,22,24,.96);color:#fff;
  transform:translateX(100%);transition:.18s ease;
  z-index:99999;display:flex;flex-direction:column;
  border-left:1px solid rgba(255,255,255,.12);
}
.open .mask{opacity:1;pointer-events:auto;}
.open .drawer{transform:translateX(0);}

.loading{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;
  background:rgba(0,0,0,.25);
  opacity:0;pointer-events:none;transition:.18s ease;
  z-index:100000;
}
.loading.show{opacity:1;pointer-events:auto;}
.loading-box{
  display:flex;align-items:center;gap:10px;
  padding:10px 14px;border-radius:12px;
  background:rgba(20,20,22,.96);color:#fff;
  border:1px solid rgba(255,255,255,.12);
  box-shadow:0 10px 30px rgba(0,0,0,.25);
  font-size:13px;
}
.spinner{
  width:16px;height:16px;border-radius:50%;
  border:2px solid rgba(255,255,255,.25);
  border-top-color:#fff;
  animation:spin .8s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg);}}
.drawer-hd{padding:12px 14px;border-bottom:1px solid rgba(255,255,255,.12);display:flex;align-items:center;justify-content:space-between;}
.btn{
  background:rgba(255,255,255,.10);
  border:1px solid rgba(255,255,255,.18);
  color:#fff;padding:7px 10px;border-radius:12px;
  cursor:pointer;font-size:13px;
}
.btn:disabled{
  opacity:.5;
  cursor:not-allowed;
}
.btn:hover{background:rgba(255,255,255,.14);}
.btn.danger{border-color:rgba(255,107,107,.45);}
.btn.primary{border-color:rgba(99,102,241,.55);}

/* Buttons on light backgrounds (list + map info window) */
.side .btn,
.amap-info-content .btn,
.btn.nav-btn{
  background:#111;
  border-color:#111;
  color:#fff;
}
.side .btn:hover,
.amap-info-content .btn:hover,
.btn.nav-btn:hover{
  background:#222;
}
.drawer-bd{
  padding:12px 14px;
  overflow:auto;
  flex:1;
  padding-bottom:calc(12px + env(safe-area-inset-bottom));
  display:flex;
  flex-direction:column;
  gap:12px;
}
.sec{
  border:1px solid rgba(255,255,255,.12);
  background:rgba(255,255,255,.06);
  border-radius:14px;
  padding:12px;
  margin-bottom:0;
}
#secManage{
  flex:0 0 auto;
  max-height:none;
  overflow:visible;
}
.drawer-bd > .sec:not(#secManage){
  flex:0 0 auto;
  max-height:34vh;
  overflow:auto;
}
.sec h3{margin:0 0 8px 0;font-size:14px;}
.small{font-size:12px;color:rgba(255,255,255,.72);line-height:1.5;}
.edit-hint{
  color:rgba(255,255,255,.72);
  background:rgba(255,255,255,.06);
  border:1px solid rgba(255,255,255,.12);
  border-radius:10px;
  padding:6px 8px;
}
.edit-hint.is-success{color:#22c55e;border-color:rgba(34,197,94,.45);background:rgba(34,197,94,.08);}
.edit-hint.is-error{color:#ef4444;border-color:rgba(239,68,68,.45);background:rgba(239,68,68,.08);}
.edit-hint.is-warn{color:#f59e0b;border-color:rgba(245,158,11,.45);background:rgba(245,158,11,.08);}
.row{display:flex;gap:8px;flex-wrap:wrap;align-items:center;}
.row input,.row textarea{
  padding:7px 9px;border-radius:10px;border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.10);color:#fff;font-size:13px;
  outline:none;
  box-sizing:border-box;
}
.row select{
  padding:7px 9px;border-radius:10px;border:1px solid rgba(255,255,255,.18);
  background:rgba(255,255,255,.10);color:#fff;
  font-size:13px;
  box-sizing:border-box;
  outline:none;
}
.row input{flex:1;min-width:180px;}
.row textarea{width:100%;min-height:140px;resize:vertical;white-space:pre;font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;}
.split{display:grid;grid-template-columns:1fr;gap:8px;}
/* 日志：强制深色背景 + 浅色文字 */
.logs{
  font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace;
  font-size: 12px;
  line-height: 1.4;
  background: #0b0b0d !important;
  color: #eaeaea !important;
  border: 1px solid rgba(255,255,255,.14);
  border-radius: 12px;
  padding: 10px;
  height: 34vh;
  overflow: auto;
  white-space: pre-wrap;
  word-break: break-word;
}
.logs *{ color: inherit !important; }

@media (max-width: 920px){
  .layout{
    grid-template-columns:1fr;
    display:flex;
    flex-direction:column;
    height:calc(var(--vh, 1vh) * 100 - 54px);
  }
  .topbar{
    display:grid;
    grid-template-columns:1fr 1fr;
    grid-template-areas:
      "city cat"
      "search search";
    gap:10px;
  }
  #city{grid-area:city;}
  #cat{grid-area:cat;}
  .q-wrap{grid-area:search;}
  .topbar select,.topbar input{width:100%;box-sizing:border-box;}
  .q-wrap{min-width:0;}
  .side{
    flex:0 0 42%;
    min-height:0;
    border-left:none;
    border-top:1px solid var(--border);
  }
  #map{
    flex:1 1 58%;
    min-height:0;
  }
}

@media (max-width: 480px){
  .fab{right:12px;bottom:12px;}
  .drawer{
    width:100vw;
    border-left:none;
  }
  .drawer-hd{
    padding:14px 14px;
  }
  .drawer-bd{
    padding:12px 12px 18px 12px;
  }
  .sec{padding:10px;border-radius:12px;}
  .row{
    flex-direction:column;
    align-items:stretch;
    gap:10px;
  }
  .row input,
  .row select,
  .row textarea,
  .row .btn{
    width:100%;
  }
  .btn{
    padding:9px 12px;
    font-size:14px;
  }
  .logs{height:30vh;}
  #secManage{max-height:none;}
  .drawer-bd > .sec:not(#secManage){max-height:30vh;}
}
